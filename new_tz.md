Техническое задание
Проект: Unison-AI
 
1. Аутентификация (Authentication)
1.1. Восстановление пароля (Forgot Password Flow)
Проблема:
•	Отсутствует страница сброса пароля и API-эндпоинты.
•	В app/auth/login/page.tsx нет ссылки «Forgot password?».
Задачи:
•	 Создать страницу /auth/reset-password.
•	 Реализовать API /api/auth/forgot-password и /api/auth/reset-password (через Supabase или собственную логику).
•	 Добавить ссылку «Forgot password?» на странице входа.
•	 Обеспечить обработку ошибок и валидацию токена сброса.
 
1.2. Защита маршрутов (Route Gating)
Проблема:
•	Страница /job-seeker/search доступна без авторизации и без прохождения теста.
Задачи:
•	 Обновить middleware.ts и добавить /job-seeker/search в protectedRoutes.
•	 Проверять статус тестирования пользователя (личностный тест).
•	 Редиректить неподготовленных пользователей на страницу прохождения теста.
 
2. Модуль соискателя (Job Seeker Module)
2.1. Обязательное тестирование (Personality Test)
Проблема:
•	Сейчас реализовано ограничение по тесту продуктивности, а не по личности.
•	Спецификация требует 5–7 открытых вопросов для оценки личности.
Задачи:
•	 Разработать отдельный personality test (open-ended questions).
•	 Настроить проверку его прохождения перед доступом к поиску и подаче заявок.
•	 Хранить результаты в таблице personality_analysis.
 
2.2. Страница результатов
Проблема:
•	Показываются результаты продуктивности, а не личностного анализа.
Задачи:
•	 Создать отдельную страницу /job-seeker/results с фокусом на анализ личности.
•	 Визуализировать ключевые личностные черты, сильные стороны, рекомендации.
 
2.3. Подтверждение парсинга резюме
Проблема:
•	Поля, извлечённые из AI-парсера, сразу записываются в таблицу users, без подтверждения.
Задачи:
•	 После парсинга — отобразить пользователю экран подтверждения.
•	 Разрешить редактирование перед сохранением.
•	 После подтверждения — обновить запись в users.
 
2.4. Безопасность файлов
Проблема:
•	Проверяется только тип/размер файла, антивирусного сканирования нет.
Задачи:
•	 Интегрировать API или библиотеку для антивирусной проверки (например, ClamAV).
•	 Файл должен проходить сканирование перед передачей в AI-парсер.
 
3. Модуль работодателя (Employer Module)
3.1. Сортировка и отображение кандидатов
Проблема:
•	Нет сортировки по Match Score и отображения этого показателя.
Задачи:
•	 Добавить отображение Match Score в списке кандидатов.
•	 Добавить сортировку по Match Score.
•	 Подключить реальный расчёт матчинга (AI или формула).
 
3.2. Страница кандидата
Проблема:
•	Используются статические мок-данные.
Задачи:
•	 Подключить данные из БД.
•	 Отобразить анализ личности и матчинга в реальном виде.
 
3.3. Уведомления по статусам
Проблема:
•	Нет email-уведомлений при изменении статуса заявки.
Задачи:
•	 Настроить почтовую интеграцию (SMTP, Resend или SendGrid).
•	 Реализовать отправку уведомлений соискателю при смене статуса.
 
3.4. Согласование статусов
Проблема:
•	В UI используются статусы interviewed/offered/hired, а в БД — interview/accepted/rejected.
Задачи:
•	 Обновить UI для соответствия enum в БД (application_status).
•	 Либо внести обновление в миграцию, если решено расширить список статусов.
 
4. AI Core
4.1. Использование культуры компании
Проблема:
•	При матчинге используется companies.description, а не company_culture.
Задачи:
•	 Изменить логику в match-service.ts для использования company_culture.
 
4.2. Асинхронная обработка
Проблема:
•	AI-вызовы выполняются синхронно, пользователь ждёт спиннер.
Задачи:
•	 Добавить фоновую обработку с прогрессом (очереди или временные статусы).
•	 Сохранять результаты по мере готовности.
 
5. Безопасность
Задачи:
•	 Добавить антивирусное сканирование (см. п. 2.4).
•	 Настроить безопасную email-доставку (см. п. 3.3).
 
6. UI / UX / Локализация
Проблема:
•	Отсутствует система i18n. Присутствует смесь RU/EN текстов.
Задачи:
•	 Внедрить i18n (например, next-intl или next-translate).
•	 Добавить переключатель RU/KZ в шапке сайта.
•	 Вынести все тексты в словари локализации.
 
7. База данных
7.1. Несоответствие полей users
Проблема:
•	В коде используются поля (linkedin_url, github_url, portfolio_url, current_job_title, resume_url), которых нет в схеме.
Задачи:
•	 Создать миграцию для добавления этих полей в public.users.
 
7.2. Наследие старых таблиц
Проблема:
•	В БД остались profiles, experiences, educations, но теперь эти данные хранятся в users (JSON).
Задачи:
•	 Либо удалить старые таблицы,
или
o	 Обеспечить синхронизацию при изменении.
 
7.3. Таблицы анализа личности
Проблема:
•	Одна миграция удаляет personality_analysis, но код всё ещё использует её.
Задачи:
•	 Сохранить таблицу personality_analysis.
•	 Убедиться, что логика анализа и API работают с ней.
 
7.4. Конфликт в схеме заявок
Проблема:
•	В коде используется user_id, а в БД — applicant_id.
Задачи:
•	 Унифицировать схему (выбрать одно название и обновить код/миграции).
 
8. Приоритетные задачи (Blocking Issues)
1.	 Forgot password flow.
2.	 Защитить /job-seeker/search и реализовать личностный тест.
3.	 Добавить подтверждение перед сохранением данных после AI-парсинга резюме.
4.	 Реализовать Match Score и сортировку.
5.	 Подключить реальный профиль кандидата и AI-анализ.
6.	 Настроить email-уведомления при изменении статуса.
7.	 Добавить недостающие поля в users.
8.	 Согласовать статусы UI и БД.
9.	 Использовать company_culture при матчинге.
10.	 Вернуть таблицы для personality analysis и сделать этот тест обязательным.
 
9. Рекомендации (опционально)
•	 Добавить сканирование файлов на вирусы.
•	 Внедрить систему i18n (RU/KZ).
•	 Добавить фоновую обработку AI-задач (очереди, статус-прогресс).

